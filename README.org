#+title: Notes on installing packages from source
#+author: Yuriy Gritsenko
#+STARTUP: overview

* Preface

[[https://wiki.debian.org/DontBreakDebian][Advice For New Users On Not Breaking Their Debian System]]

* Install packages

** Git

*** Prepare

Install build dependencies:

#+begin_src shell-script
sudo aptitude build-dep git
#+end_src

*** Download and install

Source repository: https://github.com/git/git

#+begin_src shell-script
make configure
./configure --prefix=/usr/local
make all doc
sudo make install install-doc install-html
#+end_src

** Emacs

*** Prepare

Install build dependencies:

#+begin_src shell-script
sudo aptitude build-dep emacs
#+end_src

*** Download and install

Source repositories:
- https://savannah.gnu.org/projects/emacs/
- http://www.gnu.org/software/emacs/

#+begin_src shell-script
# Option 1: Basic installation
./configure --prefix=/usr/local

# Option 2: With modules support (for vterm, etc.)
# NOTE: First install libvterm-dev on Debian/Ubuntu
./configure --with-modules --prefix=/usr/local

# Build and install
make -j$(nproc)
sudo make install
#+end_src

*** Emacs 'ctags' as alternative (optional)

If you need to preserve Emacs =ctags= as an alternative (managing different ctags implementations
using the alternatives system):

#+begin_src shell-script
# First, verify current version
ctags --version
# Save the Emacs ctags binary with a versioned name
sudo cp /usr/local/bin/ctags /usr/local/bin/ctags-emacs-<version>

# Register it as an alternative (priority: 10)
sudo update-alternatives --install /usr/local/bin/ctags ctags /usr/local/bin/ctags-emacs-<version> 10
#+end_src

** Tagging

Additional resources:
- https://www.reddit.com/r/emacs/comments/3pni17/ctags_etags_or_gtags/
- https://scripter.co/ctags-systemverilog-and-emacs/

*** Ctags

**** Download and install

Source repository: https://github.com/universal-ctags/ctags ([[https://github.com/universal-ctags][universal-ctags]])

#+begin_src shell-script
git clone https://github.com/universal-ctags/ctags.git
cd ctags

# Get the last stable release tag from master branch
git checkout $(git describe --tags --abbrev=0 master)

./autogen.sh

# Install to /usr/local (ctags will be at /usr/local/bin/ctags)
./configure --prefix=/usr/local

make -j$(nproc)
sudo make install
#+end_src

**** Add alternatives (optional)

If you need to manage multiple ctags versions using alternatives system:

#+begin_src shell-script
# Backup the current version with a versioned name
sudo cp /usr/local/bin/ctags /usr/local/bin/ctags-universal-<version>

# Register it as an alternative (priority: 9)
sudo update-alternatives --install /usr/local/bin/ctags ctags /usr/local/bin/ctags-universal-<version> 9
#+end_src

**** Installation for Windows OS

[[https://github.com/universal-ctags/ctags][Universal Ctags]] - copy binary to PATH directory (download and unpack to c:\emacs\bin, overwrite default ctags.exe)

*** Global

**** Prepare

Install build dependencies (may be required):

#+begin_src shell-script
sudo aptitude build-dep global
#+end_src

**** Download and install

Download page: http://www.gnu.org/software/global/download.html

#+begin_src shell-script
# Option 1: Without exuberant-ctags
./configure --prefix=/usr/local

# Option 2: With exuberant-ctags support
./configure --prefix=/usr/local --with-exuberant-ctags=/usr/local/bin/ctags

# Build and install
make -j$(nproc)
sudo make install
#+end_src

**** Installation for Windows OS

[[https://www.gnu.org/software/global/download.html][GLOBAL]] - copy binary to PATH directory (download and unpack to c:\emacs\bin)

**** Tips

Manual: http://www.gnu.org/software/global/manual/global.pdf

Configuration:
1. Copy config file from global-pygments-plugin (sample.globalrc)
   https://github.com/yoshizow/global-pygments-plugin

2. Install Pygments (for example using pip)
   https://github.com/yoshizow/global-pygments-plugin

*** Exuberant-ctags (optional)

If you need exuberant-ctags as an alternative:

#+begin_src shell-script
# Install exuberant-ctags from repository
sudo aptitude install exuberant-ctags

# Verify the installation and version
ctags --version
# Expected output:
# Exuberant Ctags 5.9~svn20110310, Copyright (C) 1996-2009 Darren Hiebert
#   Addresses: <dhiebert@users.sourceforge.net>, http://ctags.sourceforge.net
#   Optional compiled features: +wildcards, +regex

# Register it as an alternative (priority: 11, highest priority)
sudo update-alternatives --install /usr/local/bin/ctags ctags /usr/bin/ctags-exuberant 11
#+end_src

* Remove packages installed from source

Additional resources:
- [[https://ostechnix.com/an-easy-way-to-remove-programs-installed-from-source-in-linux/][An Easy Way To Remove Programs Installed From Source In Linux]]
- [[https://www.rosehosting.com/blog/how-to-easily-remove-packages-installed-from-source-in-linux/][How to Easily Remove Packages Installed From Source in Linux]]

*** Stow - software package installation manager

GNU Stow allows you to manage programs installed from source more easily by using symlinks.

Reference: [[https://linuxconfig.org/how-to-use-gnu-stow-to-manage-programs-installed-from-source-and-dotfiles][GNU Stow to manage programs installed from source and dotfiles]]

#+begin_src shell
# 1. Install stow
sudo aptitude install stow

# 2. Build and install <package_name> to stow directory
#    (replace <package_name> with actual package name, e.g., git-2.40.0)
./configure --prefix=/usr/local/stow/<package_name>
make -j$(nproc)
sudo make install

# 3. Create symlinks from /usr/local to the stow package
cd /usr/local/stow
sudo stow --verbose=2 <package_name>

# 4. Verify installation
# 4.1. Check the symlinks created by stow
stow -vv <package_name>

# 4.2. Verify that symlinks exist in /usr/local/bin
ls -la /usr/local/bin | grep <package_name>

# 5. To remove a package later
cd /usr/local/stow
sudo stow --delete <package_name>
# Then remove the directory
sudo rm -rf /usr/local/stow/<package_name>
#+end_src
